{% for weapon in page_obj %}
<div class="glass-card weapon-card animate-fade-in"
     style="animation-delay: {{ forloop.counter0|add:1 }}00ms"
     {% if forloop.last and page_obj.has_next %}
        hx-get="{% url 'home' %}?page={{ page_obj.next_page_number }}{% if query %}&q={{ query }}{% endif %}"
        hx-trigger="revealed"
        hx-swap="afterend"
     {% endif %}
>
    <h3>{{ weapon.weapon_name }}</h3>

    <div class="weapon-meta">
        <span><i class="ri-user-line"></i> {{ weapon.user_name }}</span>
        <span><i class="ri-sword-line"></i> {{ weapon.weapon_trainer }}</span>
    </div>

    <div style="margin-top: 1rem; display: flex; justify-content: space-between; align-items: center;">
        {% if weapon.weapon_available > 0 %}
            <span class="badge badge-avail">Available: {{ weapon.weapon_available }}</span>
        {% else %}
            <span class="badge badge-low">Out of Stock</span>
        {% endif %}

        <div style="display: flex; gap: 0.5rem;">
            <a href="{% url 'edit_weapon' weapon.pk %}" class="btn-outline"
               style="padding: 0.4rem 0.8rem; border-radius: 6px;">
                <i class="ri-edit-line"></i>
            </a>
            <a href="{% url 'delete_weapon' weapon.pk %}" class="btn-outline"
               style="padding: 0.4rem 0.8rem; border-radius: 6px; color: #fb7185;">
                <i class="ri-delete-bin-line"></i>
            </a>
        </div>
    </div>
</div>

{% empty %}

<div style="grid-column: 1/-1; text-align: center; padding: 4rem; color: var(--text-muted);">
    <i class="ri-ghost-line" style="font-size: 3rem; display: block; margin-bottom: 1rem;"></i>
    <p>No weapons found matching your search.</p>
</div>

{% endfor %}
